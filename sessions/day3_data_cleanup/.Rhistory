cnn_data <- readRDS("CNN_exercise.Rds")
getwd()
cnn_data <- readRDS("../../Example_Data/CNN_exercise.Rds")
cnn_data <- readRDS("../../Example_Data/Final/CNN_exercise.Rds")
cnn_data <- readRDS("../Example_Data/Final/CNN_exercise.Rds")
# 1. authors
#   a. Separate authors into individual variables
cnn_clean <- cnn_data %>%
separate_wider_delim(authors,
delim = ";",
names_sep = "",
too_few = "align_start",
cols_remove = TRUE)
library(tidyverse)
library(stringr)
library(lubridate)
# 1. authors
#   a. Separate authors into individual variables
cnn_clean <- cnn_data %>%
separate_wider_delim(authors,
delim = ";",
names_sep = "",
too_few = "align_start",
cols_remove = TRUE)
#   b. Change author names to be Surname First
# PREVENT FROM SWITCHING BACK             done
# CHECK WHAT HAPPENS TO HYPHENATED NAMES  done
# Fails on Nicquel Terry Ellis            CIRCLE BACK TO THIS
cnn_clean <- cnn_clean %>%
mutate(authors1 = str_replace(authors1, "^(.[:alpha:]+(\\s[:alpha:]\\.)?(?!,))\\s(.+(-.+)?)" , "\\3, \\1"),
authors2 = str_replace(authors2, "^(.[:alpha:]+(\\s[:alpha:]\\.)?(?!,))\\s(.+(-.+)?)" , "\\3, \\1"),
authors3 = str_replace(authors3, "^(.[:alpha:]+(\\s[:alpha:]\\.)?(?!,))\\s(.+(-.+)?)" , "\\3, \\1"),
authors4 = str_replace(authors4, "^(.[:alpha:]+(\\s[:alpha:]\\.)?(?!,))\\s(.+(-.+)?)" , "\\3, \\1"),
authors5 = str_replace(authors5, "^(.[:alpha:]+(\\s[:alpha:]\\.)?(?!,))\\s(.+(-.+)?)" , "\\3, \\1"),
authors6 = str_replace(authors6, "^(.[:alpha:]+(\\s[:alpha:]\\.)?(?!,))\\s(.+(-.+)?)" , "\\3, \\1"))
# 2. timestamp, create one variable...
#   a. ...that includes the information whether the article was updated or
#         published on this date
#   b. ...that holds the weekday
#   c. ...that holds the date (in date format!)
#   d. ...discard the rest of the information
cnn_clean <- cnn_clean %>%
tidyr::extract(col = timestamp,
into = c("updated", "weekday", "date"),
regex = "\\n.*(Updated|Published)\\n.*,\\s([A-Z][a-z][a-z])\\s(.*)\\n\\s+",
remove = FALSE)
# Alternative using stringr
cnn_clean <- cnn_clean %>%
mutate(updated = str_extract(
timestamp,
"\\n.*(Updated|Published)\\n.*,\\s([A-Z][a-z][a-z])\\s(.*)\\n\\s+",
group = 1),
weekday =  str_extract(
timestamp,
"\\n.*(Updated|Published)\\n.*,\\s([A-Z][a-z][a-z])\\s(.*)\\n\\s+",
group = 2),
date = str_extract(
timestamp,
"\\n.*(Updated|Published)\\n.*,\\s([A-Z][a-z][a-z])\\s(.*)\\n\\s+",
group = 3))
# Date format
cnn_clean <- cnn_clean %>%
mutate(date = parse_date(date, "%B %d, %Y",
locale = locale("en")))
cnn_clean <- cnn_clean %>%
mutate(title = str_remove_all(title, "\\n"),
title = str_remove_all(title, "\\s\\s+"))
cnn_clean <- cnn_clean %>%
mutate(title = str_remove_all(title, "\\n"),
title = str_remove_all(title, "\\s\\s+"),
body = str_remove_all(body, "\\n"),
body = str_remove_all(body, "\\s\\s+"))
body
cnn_clean$body
# 2. timestamp, create one variable...
#   a. ...that includes the information whether the article was updated or
#         published on this date
#   b. ...that holds the weekday
#   c. ...that holds the date (in date format!)
#   d. ...discard the rest of the information
cnn_clean <- cnn_clean %>%
tidyr::extract(col = timestamp,
into = c("updated", "weekday", "date"),
regex = "\\n.*(Updated|Published)\\n.*,\\s([A-Z][a-z][a-z])\\s(.*)\\n\\s+",
remove = TRUE)
?str_extract
cnn_clean <- cnn_data %>%
mutate(str_match(timestamp, "\\n.*(Updated|Published)\\n.*,\\s([A-Z][a-z][a-z])\\s(.*)\\n\\s+"))
cnn_clean <- cnn_data %>%
str_match(timestamp, "\\n.*(Updated|Published)\\n.*,\\s([A-Z][a-z][a-z])\\s(.*)\\n\\s+")
cnn_clean <- cnn_data %>%
str_match_all(timestamp, "\\n.*(Updated|Published)\\n.*,\\s([A-Z][a-z][a-z])\\s(.*)\\n\\s+")
cnn_clean <- cnn_data %>%
str_match(cnn_data$timestamp, "\\n.*(Updated|Published)\\n.*,\\s([A-Z][a-z][a-z])\\s(.*)\\n\\s+")
str_match(cnn_data$timestamp, "\\n.*(Updated|Published)\\n.*,\\s([A-Z][a-z][a-z])\\s(.*)\\n\\s+")
str_match(cnn_data$timestamp, "\\n.*(?<updated>Updated|Published)\\n.*,\\s(?<weekday>[A-Z][a-z][a-z])\\s(?<date>.*)\\n\\s+")
?str_match
cnn_clean %>% cnn_data %>%
str_match(cnn_data$timestamp, "\\n.*(?<updated>Updated|Published)\\n.*,\\s(?<weekday>[A-Z][a-z][a-z])\\s(?<date>.*)\\n\\s+")
cnn_clean <- cnn_data %>%
str_match(timestamp, "\\n.*(?<updated>Updated|Published)\\n.*,\\s(?<weekday>[A-Z][a-z][a-z])\\s(?<date>.*)\\n\\s+")
sep <- str_match(cnn$timestamp, "\\n.*(?<updated>Updated|Published)\\n.*,\\s(?<weekday>[A-Z][a-z][a-z])\\s(?<date>.*)\\n\\s+")
sep <- str_match(cnn_data$timestamp, "\\n.*(?<updated>Updated|Published)\\n.*,\\s(?<weekday>[A-Z][a-z][a-z])\\s(?<date>.*)\\n\\s+")
View(sep)
sep <- as.data.frame(str_match(timestamp, "\\n.*(?<updated>Updated|Published)\\n.*,\\s(?<weekday>[A-Z][a-z][a-z])\\s(?<date>.*)\\n\\s+"))
sep <- data.frame(str_match(timestamp, "\\n.*(?<updated>Updated|Published)\\n.*,\\s(?<weekday>[A-Z][a-z][a-z])\\s(?<date>.*)\\n\\s+"))
sep <- data.frame(str_match(cnn_data$timestamp, "\\n.*(?<updated>Updated|Published)\\n.*,\\s(?<weekday>[A-Z][a-z][a-z])\\s(?<date>.*)\\n\\s+"))
sep <- data.frame(str_match(cnn_data$timestamp, "?<orig>\\n.*(?<updated>Updated|Published)\\n.*,\\s(?<weekday>[A-Z][a-z][a-z])\\s(?<date>.*)\\n\\s+"))
cnn_clean <- data.frame(str_match(cnn_data$timestamp, "\\n.*(?<updated>Updated|Published)\\n.*,\\s(?<weekday>[A-Z][a-z][a-z])\\s(?<date>.*)\\n\\s+"))
cnn_data <- readRDS("../Example_Data/Final/CNN_exercise.Rds")
# 1. authors
#   a. Separate authors into individual variables
cnn_clean <- cnn_data %>%
separate_wider_delim(authors,
delim = ";",
names_sep = "",
too_few = "align_start",
cols_remove = TRUE)
# 1. authors
#   a. Separate authors into individual variables
cnn_clean <- cnn_data %>%
separate_wider_delim(authors,
delim = ";",
names_sep = "",
too_few = "align_start",
cols_remove = TRUE)
cnn_data <- readRDS("../Example_Data/Final/CNN_exercise.Rds")
